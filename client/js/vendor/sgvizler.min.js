(function(window,undefined){"use strict";var document=window.document,S={},globalGetSet,globalDefaultsQuery,globalDefaultsChart;S.core=function(){var VERSION="0.6.0",HOMEPAGE="http://mgskjaeveland.github.io/sgvizler/",LOGOIMAGE="http://beta.data2000.no/sgvizler/misc/image/mr.sgvizler.png",CHARTSCSS="http://mgskjaeveland.github.io/sgvizler/v/0.6/sgvizler.charts.css";return{VERSION:VERSION,HOMEPAGE:HOMEPAGE,LOGOIMAGE:LOGOIMAGE,CHARTSCSS:CHARTSCSS}}();S.util=function(){var isString=function(input){return typeof input==="string"},isNumber=function(input){return typeof input==="number"},isBoolean=function(input){return typeof input==="boolean"},isPrimitive=function(input){return isString(input)||isNumber(input)||isBoolean(input)},isFunction=$.isFunction,isArray=$.isArray,URLpattern=new RegExp("^(https?:\\/\\/)?"+"((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|"+"((\\d{1,3}\\.){3}\\d{1,3}))"+"(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*"+"(\\?[;&a-z\\d%_.~+=-]*)?"+"(\\#[-a-z\\d_]*)?$","i"),isURL=function(input){return URLpattern.test(input)},inherit=function(){var Proxy=function(){};return function(Child,Parent){Proxy.prototype=Parent.prototype;Child.prototype=new Proxy;Child.prototype.constructor=Child}}(),getset=function(attr,value,setObject,returnObject){if(value!==undefined){setObject[attr]=value}return value!==undefined?returnObject:setObject[attr]},startsWith=function(string,prefix){return string.lastIndexOf(prefix,0)===0},getObjectByPath=function(path,object,create){var i,len,segments=path.split("."),cursor=object||window;for(i=0,len=segments.length;i<len;i+=1){if(cursor!==undefined&&cursor[segments[i]]===undefined&&create){cursor[segments[i]]={}}cursor=cursor&&cursor[segments[i]]}return cursor},isInArray=function(item,array){return $.inArray(item,array)!==-1},removeDuplicates=function(array){var i,len,unique=[];for(i=0,len=array.length;i<len;i+=1){if(!isInArray(array[i],unique)){unique.push(array[i])}}return unique},toArray=function(input){var output;if(input===undefined){output=[]}else if(isPrimitive(input)){output=[input]}else if(isArray(input)){output=input}else{throw new TypeError}return output},createHTMLElement=function createHTMLElement(elementType,attributes,children){var i,len,element=$(document.createElement(elementType)),attr,childs=toArray(children),child;for(attr in attributes){if(attributes.hasOwnProperty(attr)){element.attr(attr,attributes[attr])}}for(i=0,len=childs.length;i<len;i+=1){child=childs[i];if(isPrimitive(child)){element.append(child)}else if(isArray(child)){element.append(createHTMLElement.apply(undefined,child))}else{throw new TypeError}}return element};return{isString:isString,isNumber:isNumber,isBoolean:isBoolean,isPrimitive:isPrimitive,isFunction:isFunction,isArray:isArray,isURL:isURL,startsWith:startsWith,isInArray:isInArray,toArray:toArray,removeDuplicates:removeDuplicates,getObjectByPath:getObjectByPath,getset:getset,inherit:inherit,createHTMLElement:createHTMLElement}}();S.namespace=function(){var startsWith=S.util.startsWith,isString=S.util.isString,nss={rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",owl:"http://www.w3.org/2002/07/owl#",xsd:"http://www.w3.org/2001/XMLSchema#"},baseURL=null;return{get:function(prefix){return nss[prefix]},set:function(prefix,namespace){nss[prefix]=namespace},getBaseURL:function(){return baseURL},setBaseURL:function(url){baseURL=url},prefixesSPARQL:function(){var prefix,prefixes="";for(prefix in nss){if(nss.hasOwnProperty(prefix)){prefixes+="PREFIX "+prefix+": <"+nss[prefix]+">\n"}}return prefixes},prefixify:function(url){var prefix;if(isString(url)){for(prefix in nss){if(nss.hasOwnProperty(prefix)&&startsWith(url,nss[prefix])){return url.replace(nss[prefix],prefix+":")}}}return url},unprefixify:function(qname){var prefix;if(isString(qname)){for(prefix in nss){if(nss.hasOwnProperty(prefix)&&startsWith(qname,prefix+":")){return qname.replace(prefix+":",nss[prefix])}}}return qname}}}();S.registry=function(){var util=S.util,GVIZ="google.visualization",DATATABLE=GVIZ+".DataTable",GMAP="google.maps",modules={chart:[GVIZ],datatable:[]},registry={google:{visualization:{DataTable:{t:"core",d:{i:GVIZ}},LineChart:{d:{i:"corechart"}},AreaChart:{d:{i:"corechart"}},SteppedAreaChart:{d:{i:"corechart"}},PieChart:{d:{i:"corechart"}},BubbleChart:{d:{i:"corechart"}},ColumnChart:{d:{i:"corechart"}},BarChart:{d:{i:"corechart"}},ImageSparkLine:{d:{i:"imagesparkline"}},ScatterChart:{d:{i:"corechart"}},CandlestickChart:{d:{i:"corechart"}},Gauge:{d:{i:"gauge"}},OrgChart:{d:{i:"orgchart"}},TreeMap:{d:{i:"treemap"}},AnnotatedTimeLine:{d:{i:"annotatedtimeline"}},MotionChart:{d:{i:"motionchart"}},GeoChart:{d:{i:"geochart"}},GeoMap:{d:{i:"geomap"}},Map:{d:{i:"map"}},Table:{d:{i:"table"}}},maps:{Map:{d:{i:"map"}}}}};return{GVIZ:GVIZ,GMAP:GMAP,DATATABLE:DATATABLE,chartModules:function(){return modules.chart},chartFunctions:function(){var i,len,libs=modules.chart,lib,func,charts=[];for(i=0,len=libs.length;i<len;i+=1){lib=util.getObjectByPath(libs[i],registry);for(func in lib){if(lib.hasOwnProperty(func)&&(lib[func].t===undefined||lib[func].t==="chart")){charts.push(libs[i]+"."+func)}}}return charts},getDependencies:function(functionName){var regFunc=util.getObjectByPath(functionName,registry),deps=regFunc&&regFunc.d||{};if(deps.i){deps[functionName]=deps.i;delete deps.i}return deps},addFunction:function(module,name,type,dependencies){var regFunc;if(!util.isInArray(module,modules[type])){modules[type].push(module)}regFunc=util.getObjectByPath(module+"."+name,registry,true);if(type){regFunc.t=type}if(dependencies){regFunc.d=dependencies}}}}();S.logger=function(){var startTime=Date.now(),elapsedTime=function(){return(Date.now()-startTime)/1e3},waitingCharts=0;return{log:function(message){console.log(elapsedTime()+"s: "+message)},loadingChart:function(){waitingCharts+=1;if(!$("body,html").css("cursor","progress")){$("body,html").css("cursor","progress")}},doneLoadingChart:function(){waitingCharts-=1;if(waitingCharts===0&&$("body,html").css("cursor","progress")){$("body,html").css("cursor","default")}}}}();S.charts=function(){var inherit=S.util.inherit,addFunction=S.registry.addFunction,Chart,add=function(module,name,draw,dependencies){var NewChart=function(container){Chart.call(this,container)};inherit(NewChart,Chart);NewChart.prototype.draw=draw;addFunction(module,name,"chart",dependencies);return NewChart};Chart=function(){var C=function(container){this.container=container;this.listeners={}};C.prototype={addListener:function(name,func){if(typeof func==="function"){this.listeners[name]=this.listeners[name]||[];this.listeners[name].push(func)}else{throw new TypeError}},fireListener:function(name){if(this.listeners[name]){while(this.listeners[name].length){this.listeners[name].pop()()}}}};return C}();return{add:add}}();S.datatables=function(){var addFunction=S.registry.addFunction,add=function(module,name,func,dependencies){addFunction(module,name,"datatable",dependencies);return func};return{add:add}}();S.parser=function(){var namespace=S.namespace,datatypeXSD2JS=function(){var xsdns=namespace.get("xsd"),table=[];table[xsdns+"float"]="number";table[xsdns+"decimal"]="number";table[xsdns+"int"]="number";table[xsdns+"integer"]="number";table[xsdns+"long"]="number";table[xsdns+"boolean"]="boolean";table[xsdns+"date"]="date";table[xsdns+"dateTime"]="datetime";table[xsdns+"time"]="timeofday";return table}(),getGoogleJsonDatatype=function(sdatatype){return datatypeXSD2JS[sdatatype]||"string"},getGoogleJsonValue=function(value,gdatatype,stype){var newvalue;if(gdatatype==="number"){newvalue=Number(value)}else if(gdatatype==="date"){newvalue=new Date(value.substr(0,4),value.substr(5,2),value.substr(8,2))}else if(gdatatype==="datetime"){newvalue=new Date(value.substr(0,4),value.substr(5,2),value.substr(8,2),value.substr(11,2),value.substr(14,2),value.substr(17,2))}else if(gdatatype==="timeofday"){newvalue=[value.substr(0,2),value.substr(3,2),value.substr(6,2)]}else{if(stype==="uri"){newvalue=namespace.prefixify(value)}newvalue=value}return newvalue};return{convertXML:function(sxml){var c,clen,r,gcols=[],grows=[],gdatatype=[],sresults=$(sxml).find("sparql").find("results").find("result");c=0;$(sxml).find("sparql").find("head").find("variable").each(function(){var sdatatype=null,name=$(this).attr("name"),scell=null,scells=$(sresults).find('binding[name="'+name+'"]');if(scells.length){scell=$(scells).first().children().first()[0];sdatatype=$(scell).attr("datatype")}gdatatype[c]=getGoogleJsonDatatype(sdatatype);gcols[c]={id:name,label:name,type:gdatatype[c]};c+=1});r=0;$(sresults).each(function(){var gvalue,scells,scell,stype,svalue,grow=[];for(c=0,clen=gcols.length;c<clen;c+=1){gvalue=null;scells=$(this).find('binding[name="'+gcols[c].id+'"]');if(scells.length&&$(scells).first().children().first()&&$(scells).first().children().first()[0]){scell=$(scells).first().children().first()[0];stype=scell.nodeName;svalue=$(scell).first().text();gvalue=getGoogleJsonValue(svalue,gdatatype[c],stype)}grow[c]={v:gvalue}}grows[r]={c:grow};r+=1});return{cols:gcols,rows:grows}},convertJSON:function(stable){var c,clen,r,rlen,srow,grow,gvalue,sdatatype,gcols=[],grows=[],gdatatype=[],scols=stable.head.vars,srows=stable.results.bindings;for(c=0,clen=scols.length;c<clen;c+=1){r=0;while(r+1<srows.length&&srows[r][scols[c]]===undefined){r+=1}sdatatype=srows[r]&&(srows[r][scols[c]]&&srows[r][scols[c]].datatype)||null;gdatatype[c]=getGoogleJsonDatatype(sdatatype);gcols[c]={id:scols[c],label:scols[c],type:gdatatype[c]}}for(r=0,rlen=srows.length;r<rlen;r+=1){srow=srows[r];grow=[];for(c=0,clen=scols.length;c<clen;c+=1){gvalue=null;if(srow[scols[c]]&&srow[scols[c]].value){gvalue=getGoogleJsonValue(srow[scols[c]].value,gdatatype[c],srow[scols[c]].type)}grow[c]={v:gvalue}}grows[r]={c:grow}}return{cols:gcols,rows:grows}},countXML:function(sxml){return $(sxml).find("sparql").find("results").find("result").length},countJSON:function(stable){return stable.results.bindings&&stable.results.bindings.length}}}();S.loader=function(){var util=S.util,logger=S.logger,registry=S.registry,moduleGooVis=registry.GVIZ,moduleGooMap=registry.GMAP,loaders={},loadGVizScript=function(packages,loadLib){var loader,promise={},packs=util.removeDuplicates(packages).sort(),options;if(packs.length||loadLib){loader=$.Deferred();options={callback:function(){loader.resolve();loaders[moduleGooVis].resolve();logger.log("loadGVizScript: packages LOADED: "+packs)}};if(packs.length){options.packages=packs}google.load("visualization","1",options);logger.log("loadGVizScript: loading packages: "+packs);promise=loader.promise()}return promise},loadGMapScript=function(){var loader=$.Deferred(),options={other_params:"sensor=false",callback:function(){loader.resolve();logger.log("loadGVizScript: google.maps. LOADED: ")}};google.load("maps","3",options);logger.log("loadGMapScript: loading google.maps.");return loader.promise()},loadDependencies=function(functions){var i,ilen,func,deferreds=[],gVizPacks=[],gLoader,deps,dep,loadGLib;functions=util.removeDuplicates(util.toArray(functions));while(functions.length){func=functions.pop();deps=registry.getDependencies(func);for(dep in deps){if(deps.hasOwnProperty(dep)){if(loaders[deps[dep]]){deferreds.push(loaders[deps[dep]])}else if(util.getObjectByPath(dep)===undefined){if(util.startsWith(dep,moduleGooVis)){if(dep===registry.DATATABLE){loadGLib=true;loaders[deps[dep]]=$.Deferred()}else{gVizPacks.push(deps[dep])}}else if(util.startsWith(dep,moduleGooMap)){loaders[deps[dep]]=loadGMapScript();deferreds.push(loaders[deps[dep]]);logger.log("loadDependencies: loading script: "+deps[dep])}else{loaders[deps[dep]]=$.getScript(deps[dep]).done(function(){logger.log("loadDependencies: loaded: "+deps[dep])});deferreds.push(loaders[deps[dep]]);logger.log("loadDependencies: loading script: "+deps[dep])}}}}}if(gVizPacks.length||loadGLib){gLoader=loadGVizScript(gVizPacks,loadGLib);deferreds.push(gLoader);for(i=0,ilen=gVizPacks.length;i<ilen;i+=1){loaders[gVizPacks[i]]=gLoader}}return $.when.apply($,deferreds)};return{loadDependencies:loadDependencies}}();S.defaults=function(){var moduleGooVis=S.registry.GVIZ,queryDefaults={query:"SELECT ?class (count(?instance) AS ?noOfInstances)\n"+"WHERE{ ?instance a ?class }\n"+"GROUP BY ?class\n"+"ORDER BY ?class",froms:[],endpoint:"http://sws.ifi.uio.no/sparql/world",endpoint_output_format:"json",endpoint_results_urlpart:"?output=text&amp;query=",validator_url:"http://sparql.org/validate/query"+"?languageSyntax=SPARQL"+"&amp;outputFormat=sparql"+"&amp;linenumbers=true"+"&amp;query=",chart:moduleGooVis+".Table",loglevel:2},chartDefaults={width:800,height:400,chartArea:{left:"5%",top:"5%",width:"75%",height:"80%"}},chartSpecificDefaults=function(){var options={};options[moduleGooVis+".GeoMap"]={dataMode:"markers"};options[moduleGooVis+".Map"]={dataMode:"markers"};options[moduleGooVis+".Sparkline"]={showAxisLines:false};return options}();return{query:queryDefaults,chart:chartDefaults,getQueryOptions:function(){return $.extend({},queryDefaults)},getChartOptions:function(){return $.extend({},chartDefaults)},getChartSpecificOptions:function(chart){return $.extend({},chartSpecificDefaults[chart])},setChartSpecificOption:function(chart,option,value){chartSpecificDefaults[chart]=chartSpecificDefaults[chart]||{};chartSpecificDefaults[chart][option]=value}}}();S.Query=function(queryOpt,chartOpt){var util=S.util,getset=util.getset,prefixesSPARQL=S.namespace.prefixesSPARQL,registry=S.registry,moduleGooVis=registry.GVIZ,fDataTable=registry.DATATABLE,parser=S.parser,loadDependencies=S.loader.loadDependencies,logger=S.logger,defaults=S.defaults,qfXML="xml",qfJSON="json",qfJSONP="jsonp",queryOptions,chartOptions,listeners={},dataTable,queryResult,noOfResults,addFrom=function(url){queryOptions.froms.push(url)},clearFroms=function(){queryOptions.froms=[]},query=function(queryString){if(queryString!==undefined){clearFroms()}return getset("query",queryString,queryOptions,this)},endpointURL=function(url){return getset("endpoint",url,queryOptions,this)},endpointOutputFormat=function(format){return getset("endpoint_output_format",format,queryOptions,this)},endpointResultsURLPart=function(value){return getset("endpoint_results_urlpart",value,queryOptions,this)},validatorURL=function(url){return getset("validator_url",url,queryOptions,this)},loglevel=function(value){return getset("loglevel",value,queryOptions,this)},logContainer=function(value){return getset("logContainer",value,queryOptions,this)},datatableFunction=function(functionName){return getset("datatable",functionName,queryOptions,this)},chartFunction=function(functionName){return getset("chart",functionName,queryOptions,this)},chartHeight=function(height){return getset("height",height,chartOptions,this)},chartWidth=function(width){return getset("width",width,chartOptions,this)},getEncodedQuery=function(){return encodeURIComponent(prefixesSPARQL()+query())},insertFrom=function(){var i,len=queryOptions.froms.length,from;if(len){from="";for(i=0;i<len;i+=1){from+="FROM <"+queryOptions.froms[i]+">\n"}query(query().replace(/((WHERE)?(\s)*\{)/i,"\n"+from+"$1"))}},getResultRowCount=function(dataTable){if(noOfResults===undefined){if(endpointOutputFormat()===qfXML){noOfResults=parser.countXML(dataTable)}else{noOfResults=parser.countJSON(dataTable)}}return noOfResults},getGoogleJSON=function(data){var gJSON={};if(getResultRowCount(data)){if(endpointOutputFormat()===qfXML){gJSON=parser.convertXML(data)}else{gJSON=parser.convertJSON(data)}}return gJSON},addListener=function(name,func){if(typeof func==="function"){listeners[name]=listeners[name]||[];listeners[name].push(func)}else{throw new TypeError}},fireListener=function(name){if(listeners[name]){while(listeners[name].length){listeners[name].pop()()}}},sendQuery=function(){var promise,myEndpointOutput=endpointOutputFormat();insertFrom();if(myEndpointOutput!==qfJSONP&&window.XDomainRequest){promise=function(){var qx=$.Deferred(),xdr=new XDomainRequest,url=endpointURL()+"?query="+getEncodedQuery()+"&output="+myEndpointOutput;xdr.open("GET",url);xdr.onload=function(){var data;if(myEndpointOutput===qfXML){data=$.parseXML(xdr.responseText)}else{data=$.parseJSON(xdr.responseText)}qx.resolve(data)};xdr.send();return qx.promise()}()}else{promise=$.ajax({url:endpointURL(),data:{query:prefixesSPARQL()+query(),output:myEndpointOutput===qfJSONP?qfJSON:myEndpointOutput},dataType:myEndpointOutput})}return promise},saveQueryResults=function(){var qr;if(queryResult!==undefined){qr=queryResult}else{qr=sendQuery();qr.fail(function(xhr,textStatus,thrownError){logger.log("Error: A '"+textStatus+"' occurred in Query.saveQueryResults()");fireListener("onFail")});qr.done(function(data){queryResult=data;fireListener("onDone")})}return qr},saveDataTable=function(){var qdt,myDatatableFunction=datatableFunction();if(dataTable){qdt=dataTable}else{qdt=$.when(saveQueryResults(),loadDependencies(fDataTable),function(){var loader={};if(myDatatableFunction){loader=loadDependencies(myDatatableFunction)}return loader}()).done(function(){dataTable=new google.visualization.DataTable(getGoogleJSON(queryResult));if(myDatatableFunction){var func=util.getObjectByPath(myDatatableFunction);dataTable=func(dataTable)}})}return qdt},draw=function(containerId){var myChart=chartFunction();$.when(saveDataTable(),loadDependencies(myChart)).then(function(){try{var Func=util.getObjectByPath(myChart),chartFunc=new Func(document.getElementById(containerId)),ready=function(){logger.log(myChart+" for "+containerId+" is ready.");fireListener("onDraw")};if(util.startsWith(myChart,moduleGooVis)){google.visualization.events.addListener(chartFunc,"ready",ready)}else if(chartFunc.addListener){chartFunc.addListener("ready",ready)}chartFunc.draw(dataTable,chartOptions)}catch(x){logger.log(myChart+" -- "+x)}})};queryOptions=$.extend(defaults.getQueryOptions(),queryOpt);chartOptions=$.extend(defaults.getChartOptions(),defaults.getChartSpecificOptions(chartFunction()),chartOpt);if(!(this instanceof S.Query)){throw new Error("Constructor 'Query' called as a function. Use 'new'.")}return{noOfResults:noOfResults,draw:draw,getEncodedQuery:getEncodedQuery,onFail:function(func){addListener("onFail",func)},onDone:function(func){addListener("onDone",func)},onDraw:function(func){addListener("onDraw",func)},getDataTable:function(success,fail){$.when(saveDataTable()).then(function(){var data=dataTable.clone();success(data)},function(){var data=dataTable.clone();fail(data)})},addFrom:addFrom,clearFroms:clearFroms,query:query,endpointURL:endpointURL,endpointOutputFormat:endpointOutputFormat,endpointResultsURLPart:endpointResultsURLPart,validatorURL:validatorURL,loglevel:loglevel,logContainer:logContainer,datatableFunction:datatableFunction,chartFunction:chartFunction,chartHeight:chartHeight,chartWidth:chartWidth}};S.container=function(){var util=S.util,loadDependencies=S.loader.loadDependencies,logger=S.logger,Query=S.Query,PREFIX="data-sgvizler-",PREFIXCHART=PREFIX+"chart-options",VALUEASSIGN="=",VALUESPLIT="|",getQueryAttributes=function(elementID){var i,len,queryOpt={},elmAttrs=document.getElementById(elementID).attributes;for(i=0,len=elmAttrs.length;i<len;i+=1){if(util.startsWith(elmAttrs[i].name,PREFIX)){queryOpt[elmAttrs[i].name.substring(PREFIX.length)]=elmAttrs[i].value}}return queryOpt},getChartAttributes=function(elementID){var i,j,ilen,jlen,options,assignment,path,o,chartOpt={},attrValue=$("#"+elementID).attr(PREFIXCHART);if(attrValue!==undefined){options=attrValue.split(VALUESPLIT);for(i=0,ilen=options.length;i<ilen;i+=1){assignment=options[i].split(VALUEASSIGN);path=assignment[0].split(".");o=chartOpt;for(j=0,jlen=path.length-1;j<jlen;j+=1){if(o[path[j]]===undefined){o[path[j]]={}}o=o[path[j]]}o[path[j]]=assignment[1]}}chartOpt.width=/(\d+)/.exec($("#"+elementID).css("width"))[1];chartOpt.height=/(\d+)/.exec($("#"+elementID).css("height"))[1];return chartOpt},loadDependenciesOnPage=function(strFunctions){strFunctions=util.toArray(strFunctions);$("["+PREFIX+"chart]").each(function(){strFunctions.push($(this).attr(PREFIX+"chart"))});logger.log("initializer: loading functions: "+strFunctions);loadDependencies(strFunctions)},draw=function(elementID){var queryOptions=getQueryAttributes(elementID),chartOptions=getChartAttributes(elementID),froms=queryOptions.rdf&&queryOptions.rdf.split(VALUESPLIT)||[],query=new Query(queryOptions,chartOptions);while(froms.length){query.addFrom(froms.pop())}logger.log("drawing id: "+elementID);query.draw(elementID)},drawAll=function(){loadDependenciesOnPage();$("["+PREFIX+"query]").each(function(){draw($(this).attr("id"))})};return{draw:draw,drawAll:drawAll}}();S.form=function(){var util=S.util,prefixesSPARQL=S.namespace.prefixesSPARQL,registry=S.registry,Query=S.Query,idprefix="sgvzlr_",idMainCon=idprefix+"mainCon",idFormCon=idprefix+"formCon",idChartCon=idprefix+"gchart",idQueryForm=idprefix+"formQuery",idQueryTxt=idprefix+"cQuery",idFormQuery=idprefix+"strQuery",idFormEndpointGrp=idprefix+"strEndpointGrp",idFormEndpoint=idprefix+"strEndpoint",idFormFormatGrp=idprefix+"btnFormatGrp",idFormFormat=idprefix+"btnFormat",idFormSizeGrp=idprefix+"strSizeGrp",idFormWidth=idprefix+"strWidth",idFormHeight=idprefix+"strHeight",idFormChartGrp=idprefix+"optChartGrp",idFormChart=idprefix+"optChart",idFormButtonGrp=idprefix+"btnSendGrp",idPrefixCon=idprefix+"cPrefix",idMessageCon=idprefix+"cMessage",idLogo=idprefix+"logo",idFooter=idprefix+"footer",html=function(){return{heading:["h1",null,["Sgvizler"]],logo:["div",{id:idLogo},[["a",{href:S.core.HOMEPAGE},[["img",{src:S.core.LOGOIMAGE,alt:"Mr. Sgvizler"}]]],"Mr. Sgvizler"]],main:["div",{id:idFormCon},[["pre",{id:idPrefixCon}],["textarea",{id:idQueryTxt,rows:"10",cols:"80"}],["form",{id:idQueryForm,method:"get"},[["p",null,[["input",{id:idFormQuery,type:"hidden",name:"query",value:""}],["span",{id:idFormEndpointGrp},[["label",{"for":idFormEndpoint},["Endpoint: "]],["input",{id:idFormEndpoint,type:"text",name:"endpoint",size:"30"}]]],["span",{id:idFormFormatGrp},[["label",{"for":idFormFormat},["Output format: "]],["input",{id:idFormFormat,type:"radio",name:"endpoint_output",value:"xml"}],"xml ",["input",{id:idFormFormat,type:"radio",name:"endpoint_output",value:"json"}],"json ",["input",{id:idFormFormat,type:"radio",name:"endpoint_output",value:"jsonp"}],"jsonp"]],["span",{id:idFormChartGrp},[["label",{"for":idFormChart},["Chart type: "]],["select",{id:idFormChart,name:"chart"}]]],["span",{id:idFormSizeGrp},[["label",{"for":idFormWidth},["Width: "]],["input",{id:idFormWidth,name:"width",type:"text",size:"3"}],["label",{"for":idFormHeight},["Height: "]],["input",{id:idFormHeight,name:"height",type:"text",size:"3"}]]],["span",{id:idFormButtonGrp},[["input",{type:"button",value:"Reset",onclick:"sgvizler.formReset()"}],["input",{type:"button",value:"Go",onclick:"sgvizler.formSubmit()"}]]]]]]],["div",{id:idMessageCon}]]],chart:["div",{id:idChartCon,style:"width:800px; height:400px;"}],footer:["div",{id:idFooter},[["p",null,[["a",{href:S.core.HOMEPAGE},["Sgvizler"]]," version "+S.core.VERSION+" (c) 2011&ndash;2013 Martin G. Skj&#230;veland."]]]]}}(),permissible_urlparams=["query","endpoint","endpoint_output","chart","width","height","ui"],isElement=function(elementID){return $("#"+elementID).length>0},setElementValue=function(elementID,value){if(isElement(elementID)){$("#"+elementID).val(value)}},setElementText=function(elementID,text){if(isElement(elementID)){$("#"+elementID).text(text)}},displayPrefixes=function(){setElementText(idPrefixCon,prefixesSPARQL())},displayUserInput=function(query){setElementValue(idQueryTxt,query.query());setElementValue(idFormEndpoint,query.endpointURL());$("input:radio[id="+idFormFormat+"][value="+query.endpointOutputFormat()+"]").attr("checked",true);setElementValue(idFormChart,query.chartFunction());setElementValue(idFormWidth,query.chartWidth());setElementValue(idFormHeight,query.chartHeight())},displayChartTypesMenu=function(){var i,j,ilen,jlen,charts=registry.chartFunctions().sort(),createOptGrp=function(name){return util.createHTMLElement("optgroup",{label:name+".*"})},libs=registry.chartModules(),group={},added=false;if(isElement(idFormChart)){for(j=0,jlen=libs.length;j<jlen;j+=1){group[libs[j]]=createOptGrp(libs[j]);$("#"+idFormChart).append(group[libs[j]])}for(i=0,ilen=charts.length;i<ilen;i+=1){added=false;for(j=0,jlen=libs.length;j<jlen;j+=1){if(util.startsWith(charts[i],libs[j])){$(group[libs[j]]).append($("<option/>").val(charts[i]).html(charts[i].replace(libs[j]+".","")));added=true}}if(!added){$("#"+idFormChart).append($("<option/>").val(charts[i]).html(charts[i]))}}}},createUI=function(elementID,UItype){var createHTMLElements=function(elementsArray){return util.createHTMLElement.apply(undefined,elementsArray)},setChartContainer=function(elementID){if(elementID){idChartCon=elementID}else{$("body").append(createHTMLElements(html.chart))}},setForm=function(elementID){var main;if(elementID){main=$("#"+elementID)}else{main=util.createHTMLElement("div",{id:idMainCon});$("body").append(createHTMLElements(html.logo),createHTMLElements(html.heading),main,createHTMLElements(html.footer))}main.append(createHTMLElements(html.main),createHTMLElements(html.chart))};if(UItype==="result"){setChartContainer(elementID)}else{setForm(elementID)}},displayUI=function(query){displayPrefixes();displayChartTypesMenu();displayUserInput(query)},getUrlParams=function(urlparams){var urlParams={},e,r=/([^&=]+)=?([^&]*)/g,d=function(s){return decodeURIComponent(s.replace(/\+/g," "))},q=window.location.search.substring(1),params=urlparams||permissible_urlparams;while((e=r.exec(q))!==null){if(e[2].length>0&&util.isInArray(e[1],params)){urlParams[d(e[1])]=d(e[2])}}return urlParams},reset=function(){document.location=window.location.href.replace(window.location.search,"")},submit=function(){$("#"+idFormQuery).val($("#"+idQueryTxt).val());$("#"+idQueryForm).submit()},draw=function(elementID){var params=getUrlParams(),query=new Query({query:params.query,chart:params.chart,endpoint:params.endpoint,endpoint_output:params.endpoint_output},{width:params.width,height:params.height});createUI(elementID,params.ui);displayUI(query);if(isElement(idChartCon)&&params.query){query.logContainer(idMessageCon);query.draw(idChartCon)}};return{draw:draw,reset:reset,submit:submit}}();S.visualization=function(){var util=S.util,namespace=S.namespace,charts=S.charts,C={},modSC="sgvizler.visualization";C.D3ForceGraph=charts.add(modSC,"D3ForceGraph",function(data,chartOpt){var r,noRows=data.getNumberOfRows(),i,len,noColumns=data.getNumberOfColumns(),opt=$.extend({maxnodesize:15,minnodesize:2},chartOpt),colors=d3.scale.category20(),w=chartOpt.width,h=chartOpt.height,isNumber=function(n){return!isNaN(parseFloat(n))&&isFinite(n)},nodes=[],edges=[],t_color={},t_size={},t_maxnodesize=0,source,target,nodesizeratio,color,size,vis,force,link,node,ticks;C.util.loadCSS();for(r=0;r<noRows;r+=1){source=data.getValue(r,0);target=data.getValue(r,1);if(source!==null&&$.inArray(source,nodes)===-1){nodes.push(source);t_size[source]=noColumns>2?Math.sqrt(data.getValue(r,2)):0;t_color[source]=noColumns>3?data.getValue(r,3):0;if(t_size[source]>t_maxnodesize){t_maxnodesize=t_size[source]}}if(target!==null&&$.inArray(target,nodes)===-1){nodes.push(target)}if(source!==null&&target!==null){edges.push({source:$.inArray(source,nodes),target:$.inArray(target,nodes)})}}if(t_maxnodesize===0){t_maxnodesize=1}nodesizeratio=opt.maxnodesize/t_maxnodesize;for(i=0,len=nodes.length;i<len;i+=1){color=t_color[nodes[i]]!==undefined?t_color[nodes[i]]:1;size=isNumber(t_size[nodes[i]])?opt.minnodesize+t_size[nodes[i]]*nodesizeratio:opt.minnodesize;nodes[i]={name:nodes[i],color:color,size:size}}$(this.container).empty();vis=d3.select(this.container).append("svg:svg").attr("width",w).attr("height",h).attr("pointer-events","all").append("svg:g").call(d3.behavior.zoom().on("zoom",function(){vis.attr("transform","translate("+d3.event.translate+")"+" scale("+d3.event.scale+")")})).append("svg:g");vis.append("svg:rect").attr("width",w).attr("height",h).attr("fill","white");force=d3.layout.force().gravity(.05).distance(100).charge(-100).nodes(nodes).links(edges).size([w,h]).start();link=vis.selectAll("line.link").data(edges).enter().append("svg:line").attr("class","link").attr("x1",function(d){return d.source.x}).attr("y1",function(d){return d.source.y}).attr("x2",function(d){return d.target.x}).attr("y2",function(d){return d.target.y});node=vis.selectAll("g.node").data(nodes).enter().append("svg:g").attr("class","node").call(force.drag);node.append("svg:circle").style("fill",function(d){return colors(d.color)}).attr("class","node").attr("r",function(d){return d.size});node.append("svg:title").text(function(d){return d.name});node.append("svg:text").attr("class","nodetext").attr("dx",12).attr("dy",".35em").text(function(d){return d.name});ticks=0;force.on("tick",function(){ticks+=1;if(ticks>250){force.stop();force.charge(0).linkStrength(0).linkDistance(0).gravity(0).start()}link.attr("x1",function(d){return d.source.x}).attr("y1",function(d){return d.source.y}).attr("x2",function(d){return d.target.x}).attr("y2",function(d){return d.target.y});node.attr("transform",function(d){return"translate("+d.x+","+d.y+")"})});this.fireListener("ready")},{d3:"//cdnjs.cloudflare.com/ajax/libs/d3/2.10.0/d3.v2.min.js"});C.DefList=charts.add(modSC,"DefList",function(data,chartOpt){var r,noRows=data.getNumberOfRows(),c,noColumns=data.getNumberOfColumns(),opt=$.extend({cellSep:" ",termPrefix:"",termPostfix:":",definitionPrefix:"",definitionPostfix:""},chartOpt),list="",term,definition;for(r=0;r<noRows;r+=1){term="<dt>"+opt.termPrefix+C.util.linkify2String(data.getValue(r,0))+opt.termPostfix+"</dt>";definition="<dd>"+opt.definitionPrefix;for(c=1;c<noColumns;c+=1){definition+=C.util.linkify2String(data.getValue(r,c));if(c+1!==noColumns){definition+=opt.cellSep}}definition+=opt.definitionPostfix+"</dd>";list+=term+definition}$(this.container).empty().html(list);this.fireListener("ready")});C.DraculaGraph=charts.add(modSC,"DraculaGraph",function(data,chartOpt){var row,numberOfRows=data.getNumberOfRows(),i,len,numberOfColumns=data.getNumberOfColumns(),opt=$.extend({noderadius:.5,nodefontsize:"10px",nodeheight:20,nodestrokewidth:"1px",directed:false,nodecornerradius:"1px",nodepadding:7,nodecolor:"green",edgestroke:"blue",edgefill:"blue",edgestrokewidth:1,edgefontsize:"10px",edgeseparator:", "},chartOpt),graph=new Dracula.Graph,layouter,renderer,edge,source,target,label,nodeRenderer=function(color,URL){return function(r,n){return r.set().push(r.rect(n.point[0],n.point[1],n.label.length*opt.nodepadding,opt.nodeheight).attr({fill:color,"stroke-width":opt.nodestrokewidth,r:opt.nodecornerradius})).push(r.text(n.point[0]+n.label.length*opt.nodepadding/2,n.point[1]+opt.nodeheight/2,n.label).attr({"font-size":opt.nodefontsize}).click(function(){if(URL){window.open(namespace.unprefixify(URL))}}))}},addNode=function(URL,name,color){graph.addNode(URL,{label:name,render:nodeRenderer(color,URL)})},edges={},keys_edges=[];for(row=0;row<numberOfRows;row+=1){source=data.getValue(row,0);target=data.getValue(row,2);if(source){addNode(source,data.getValue(row,1)||source,numberOfColumns>5?data.getValue(row,5):opt.nodecolor)}if(target){addNode(target,data.getValue(row,3)||target,numberOfColumns>6?data.getValue(row,6):opt.nodecolor)}if(source&&target){label="";if(edges[source+target]!==undefined){label=edges[source+target].label}else{keys_edges.push(source+target)}if(numberOfColumns>4&&data.getValue(row,4).length>0){if(label.length>0){label+=opt.edgeseparator}label+=data.getValue(row,4)}edges[source+target]={source:source,target:target,label:label}}}for(i=0,len=keys_edges.length;i<len;i+=1){edge=edges[keys_edges[i]];graph.addEdge(edge.source,edge.target,{stroke:opt.edgestroke,directed:opt.directed,fill:opt.edgefill,label:edge.label,width:opt.edgestrokewidth,fontsize:opt.edgefontsize})}layouter=new Dracula.Graph.Layout.Spring(graph);layouter.layout();$(this.container).empty();renderer=new Dracula.Graph.Renderer.Raphael(this.container,graph,opt.width,opt.height,{
noderadius:opt.nodeheight*opt.noderadius});renderer.draw();this.fireListener("ready")},{Dracula:"http://www.data2000.no/sgvizler/lib/raphael-dracula.min.js"});C.List=charts.add(modSC,"List",function(data,chartOpt){var c,noColumns=data.getNumberOfColumns(),r,noRows=data.getNumberOfRows(),opt=$.extend({list:"ul",cellSep:", ",rowPrefix:"",rowPostfix:""},chartOpt),list="<"+opt.list+">";for(r=0;r<noRows;r+=1){list+="<li>"+opt.rowPrefix;for(c=0;c<noColumns;c+=1){list+=C.util.linkify2String(data.getValue(r,c));if(c+1!==noColumns){list+=opt.cellSep}}list+=opt.rowPostfix+"</li>"}list+="</"+opt.list+">";$(this.container).empty().html(list);this.fireListener("ready")});C.Map=charts.add(modSC,"Map",function(data,chartOpt){var c,noColumns=data.getNumberOfColumns(),r,noRows=data.getNumberOfRows(),that=this,opt=$.extend({dataMode:"markers",showTip:true,useMapTypeControl:true},chartOpt),chart,newData,newValue;C.util.loadCSS();if(noColumns>3){newData=data.clone();for(c=noColumns-1;c>2;c-=1){newData.removeColumn(c)}for(r=0;r<noRows;r+=1){newValue="<div class='sgvizler sgvizler-sMap'>";newValue+="<h1>"+data.getValue(r,2)+"</h1>";if(5<noColumns&&data.getValue(r,5)!==null){newValue+="<div class='img'><img src='"+data.getValue(r,5)+"'/></div>"}if(3<noColumns&&data.getValue(r,3)!==null){newValue+="<p class='text'>"+data.getValue(r,3)+"</p>"}if(4<noColumns&&data.getValue(r,4)!==null){newValue+="<p class='link'><a href='"+namespace.unprefixify(data.getValue(r,4))+"'>"+data.getValue(r,4)+"</a></p>"}newValue+="</div>";newData.setCell(r,2,newValue)}}else{newData=data}chart=new google.visualization.Map(this.container);chart.draw(newData,opt);google.visualization.events.addListener(chart,"ready",function(){that.fireListener("ready")})},{"google.visualization.Map":"map"});C.MapWKT=charts.add(modSC,"MapWKT",function(data,chartOpt){var noColumns=data.getNumberOfColumns(),r,noRows=data.getNumberOfRows(),opt=$.extend({zoom:5,centerLat:62,centerLong:2,geoDatumIn:"EPSG:4326",geoDatumOut:"EPSG:4326"},chartOpt),mapOptions={projection:opt.geoDatumOut,layers:[new OpenLayers.Layer.OSM,new OpenLayers.Layer.Google("Google Physical",{type:google.maps.MapTypeId.TERRAIN}),new OpenLayers.Layer.Google("Google Streets",{numZoomLevels:20}),new OpenLayers.Layer.Google("Google Hybrid",{type:google.maps.MapTypeId.HYBRID,numZoomLevels:20}),new OpenLayers.Layer.Google("Google Satellite",{type:google.maps.MapTypeId.SATELLITE,numZoomLevels:22})],controls:[new OpenLayers.Control.Navigation,new OpenLayers.Control.PanZoomBar,new OpenLayers.Control.LayerSwitcher({ascending:false}),new OpenLayers.Control.Permalink,new OpenLayers.Control.ScaleLine,new OpenLayers.Control.MousePosition,new OpenLayers.Control.OverviewMap,new OpenLayers.Control.KeyboardDefaults],center:new OpenLayers.LonLat(opt.centerLong,opt.centerLat),zoom:5},mapBounds,map=new OpenLayers.Map(this.container,mapOptions),formatterWKT=new OpenLayers.Format.WKT({internalProjection:map.baseLayer.projection,externalProjection:new OpenLayers.Projection(opt.geoDatumIn)}),resultLayer=new OpenLayers.Layer.Vector("Results",{styleMap:new OpenLayers.StyleMap({"default":new OpenLayers.Style({fillColor:"#33CC00",fillOpacity:.2,strokeColor:"#000000",strokeWidth:1})})}),labelLayer=new OpenLayers.Layer.Vector("Labels",{eventListeners:{featureselected:function(evt){var feature=evt.feature,popup=new OpenLayers.Popup.FramedCloud("popup",OpenLayers.LonLat.fromString(feature.geometry.toShortString()),null,"<div style='font-size:.8em'>"+"<b>"+feature.attributes.name+"</b><br/>"+C.util.linkify2String(feature.attributes.uri)+"<br/>"+feature.attributes.description+"</div>",null,true);feature.popup=popup;map.addPopup(popup)},featureunselected:function(evt){var feature=evt.feature;map.removePopup(feature.popup);feature.popup.destroy();feature.popup=null}},styleMap:new OpenLayers.StyleMap({"default":new OpenLayers.Style({strokeColor:"#FF0000",strokeOpacity:1,strokeWidth:5,fillColor:"#FF0000",fillOpacity:.5,pointRadius:2,label:"${name}",fontSize:"10px",fontFamily:"Arial",labelAlign:"l",labelOutlineColor:"white",labelOutlineWidth:1,labelXOffset:7})})}),selector=new OpenLayers.Control.SelectFeature(labelLayer,{click:true,autoActivate:true}),wktFeature,labelFeature,addWKT=function(layer,valueWKT){var features=formatterWKT.read(valueWKT),i;if(features){if(!util.isArray(features.constructor)){features=[features]}for(i=0;i<features.length;i+=1){if(!mapBounds){mapBounds=features[i].geometry.getBounds()}else{mapBounds.extend(features[i].geometry.getBounds())}}layer.addFeatures(features)}return features};for(r=0;r<noRows;r+=1){wktFeature=addWKT(resultLayer,data.getValue(r,0));labelFeature=new OpenLayers.Feature.Vector(wktFeature[0].geometry.getCentroid());labelFeature.attributes.name=noColumns>1&&data.getValue(r,1)?data.getValue(r,1):"";labelFeature.attributes.uri=noColumns>2&&data.getValue(r,2)?data.getValue(r,2):"";labelFeature.attributes.description=noColumns>3&&data.getValue(r,3)?data.getValue(r,3):"";labelLayer.addFeatures([labelFeature])}map.addLayer(resultLayer);map.addLayer(labelLayer);map.addControl(selector);map.zoomToExtent(mapBounds);this.fireListener("ready")},{"google.maps.Map":"google.maps.Map",OpenLayers:"//cdnjs.cloudflare.com/ajax/libs/openlayers/2.12/OpenLayers.min.js"});C.Table=charts.add(modSC,"Table",function(data,chartOpt){var c,noColumns=data.getNumberOfColumns(),r,noRows=data.getNumberOfRows(),opt=$.extend({headings:true},chartOpt),table,rows=[],cells=[];if(opt.headings){for(c=0;c<noColumns;c+=1){cells.push(["th",null,data.getColumnLabel(c)])}rows.push(["tr",null,cells])}for(r=0;r<noRows;r+=1){cells=[];for(c=0;c<noColumns;c+=1){cells.push(["td",null,[C.util.linkify2HTMLElementArray(data.getValue(r,c))]])}rows.push(["tr",null,cells])}table=util.createHTMLElement("table",null,rows);$(this.container).empty().html(table);this.fireListener("ready")});C.Text=charts.add(modSC,"Text",function(data,chartOpt){var c,noColumns=data.getNumberOfColumns(),r,noRows=data.getNumberOfRows(),opt=$.extend({cellSep:", ",cellPrefix:"",cellPostfix:"",rowPrefix:"<p>",rowPostfix:"</p>",resultsPrefix:"<div>",resultsPostfix:"</div>"},chartOpt),text=opt.resultsPrefix,row;for(r=0;r<noRows;r+=1){row=opt.rowPrefix;for(c=0;c<noColumns;c+=1){row+=opt.cellPrefix+C.util.linkify2String(data.getValue(r,c))+opt.cellPostfix;if(c+1!==noColumns){row+=opt.cellSep}}text+=row+opt.rowPostfix}text+=opt.resultsPostfix;$(this.container).empty().html(text);this.fireListener("ready")});C.util=function(){var linkify=function(url,arraySyntax){var prefixed=namespace.prefixify(url),base=namespace.getBaseURL,href=url,link,result;if(prefixed!==url){link=prefixed}else if(S.util.isURL(url)){link=url}if(link){if(base){href=base+url}if(arraySyntax){result=["a",{href:href},link]}else{result="<a href="+href+">"+link+"</a>"}}else{result=url}return result},cssloaded=false;return{linkify2String:function(url){return linkify(url,false)},linkify2HTMLElementArray:function(url){return linkify(url,true)},loadCSS:function(){if(!cssloaded){$("head").append('<link rel="stylesheet" href="'+S.core.CHARTSCSS+'" type="text/css" />');cssloaded=true}}}}();return C}();S.datatable=function(){var namespace=S.namespace,datatables=S.datatables,DT={},modST="sgvizler.datatable";DT.pivot=datatables.add(modST,"pivot",function(dataTable){var columns=dataTable.getDistinctValues(0),dataView=new google.visualization.DataView(dataTable),cary=columns.map(function(item){return{type:"number",label:item,calc:function(dt,row){return dt.getValue(row,0)===item?dt.getValue(row,2):null}}}),rary=columns.map(function(item,index){return{column:index+1,type:"number",label:item,aggregation:google.visualization.data.sum}});cary.unshift(1);dataView.setColumns(cary);return google.visualization.data.group(dataView,[0],rary)});DT.prefixify=datatables.add(modST,"prefixify",function(dataTable){var c,clen=dataTable.getNumberOfColumns(),r,rlen=dataTable.getNumberOfRows();for(c=0;c<clen;c+=1){if(dataTable.getColumnType(c)==="string"){for(r=0;r<rlen;r+=1){dataTable.setValue(r,c,namespace.prefixify(dataTable.getValue(r,c)))}}}return dataTable});return DT}();globalGetSet=S.util.getset;globalDefaultsQuery=S.defaults.query;globalDefaultsChart=S.defaults.chart;if(window.sgvizler){throw new Error("Javascript module 'sgvizler' already exists.")}window.sgvizler={VERSION:S.core.VERSION,HOMEPAGE:S.core.HOMEPAGE,chartsAdd:S.charts.add,datatablesAdd:S.datatables.add,registryChartFunctions:S.registry.chartFunctions,namespacePrefixesSPARQL:S.namespace.prefixesSPARQL,namespacePrefixify:S.namespace.prefixify,namespaceUnprefixify:S.namespace.unprefixify,containerDraw:S.container.draw,containerDrawAll:S.container.drawAll,formDraw:S.form.draw,formSubmit:S.form.submit,formReset:S.form.reset,Query:S.Query,visualization:S.visualization,datatable:S.datatable,prefix:function(prefix,namespace){if(namespace!==undefined){S.namespace.set(prefix,namespace)}return namespace!==undefined?this:S.namespace.get(prefix)},baseURL:function(url){if(url!==undefined){S.namespace.setBaseURL(url)}return url!==undefined?this:S.namespace.getBaseURL()||""},defaultQuery:function(queryString){return globalGetSet("query",queryString,globalDefaultsQuery,this)},defaultFroms:function(froms){var getset=globalGetSet("froms",froms,globalDefaultsQuery,this);if(getset!==this){getset=getset.slice(0)}return getset},defaultEndpointURL:function(endpointURL){return globalGetSet("endpoint",endpointURL,globalDefaultsQuery,this)},defaultEndpointOutputFormat:function(format){return globalGetSet("endpoint_output_format",format,globalDefaultsQuery,this)},defaultEndpointResultsURLPart:function(value){return globalGetSet("endpoint_results_urlpart",value,globalDefaultsQuery,this)},defaultValidatorURL:function(url){return globalGetSet("validator_url",url,globalDefaultsQuery,this)},defaultLogContainer:function(value){return globalGetSet("logcontainer",value,globalDefaultsQuery,this)},defaultLogLevel:function(value){return globalGetSet("loglevel",value,globalDefaultsQuery,this)},defaultDatatableFunction:function(functionName){return globalGetSet("datatable",functionName,globalDefaultsQuery,this)},defaultChartFunction:function(functionName){return globalGetSet("chart",functionName,globalDefaultsQuery,this)},defaultChartHeight:function(height){return globalGetSet("height",height,globalDefaultsChart,this)},defaultChartWidth:function(width){return globalGetSet("width",width,globalDefaultsChart,this)},defaultChartSpecificOption:function(chart,option,value){S.defaults.setChartSpecificOption(chart,option,value);return this}};jQuery.ajaxSetup({cache:true,accepts:{xml:"application/sparql-results+xml",json:"application/sparql-results+json",jsonp:"application/sparql-results+json"}})})(window);